# Generation of screening library

A screening library for testing our models is generated by using SMARTS-based rules to break synthetically accessible bonds within all screened molecules, and then enumerate & recombine between all of the synthons to generate an exhaustive library of molecules to be screened _in silico_. The top-scoring molecules are then synthesised and assayed in real life, as described in the paper (placeholder link).

The [screening library itself](https://github.com/wjm41/mpro-rank-gen/blob/main/data/screening_lib.txt.gz)  is included in the `data` folder of the git repo.

---
To generate the screening library, first run `simple_processing.py` in the `data` directory before running `initial_perturbations.py` -  this script breaks the synthetically accessible bonds within the filtered active molecules from the activity data and saves the synthons to flies in the `data` directory. Then, `run_mpi.sh` is run - this utitlizes MPI to run the ilbrary enumeration in parallel which is necessary due to the intense memory requirements for storing a large list of RDKit molecules before the removal of duplicate molecules.

`run_mpi.sh` will result in a large number of sub-library data files in the `data` directory - run `cat noncovalent_lib_final_batch_* | sort | uniq > screening_lib.txt` to concatenate all of sub-libraries into one file with unique molecular SMILES.

On one 2.6GHz core of an Intel Xeon Skylake 6142 processor, `initial_perturbations.py` takes ~45 minutes to run while `run_mpi.sh` takes ~2.5 hours. Please adjust the parameters in `run_mpi.sh` according to the computational resources available.
